<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>見取り力向上クイズ</title>
    <!-- Tailwind CSSを読み込み -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f0f9ff 0%, #cbebff 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 30px;
            max-width: 800px;
            width: 100%;
            text-align: center;
            position: relative;
            overflow: hidden;
            animation: fadeIn 0.8s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .quiz-section {
            margin-bottom: 30px;
            padding: 20px;
            border-radius: 15px;
            background-color: #f8faff;
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.05);
        }
        .question-text {
            font-size: 1.25rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .option-button {
            background-color: #e0f2fe;
            color: #007bff;
            border: 2px solid #a7d9f7;
            padding: 15px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            text-align: left;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
            display: flex;
            align-items: center;
        }
        .option-button:hover {
            background-color: #cce7ff;
            border-color: #87c5ed;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        }
        .option-button.selected {
            background-color: #007bff;
            color: #ffffff;
            border-color: #0056b3;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
        }
        .submit-button {
            background: linear-gradient(45deg, #6a82fb 0%, #fc5c7d 100%);
            color: white;
            padding: 15px 30px;
            border-radius: 10px;
            border: none;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            margin-top: 30px;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        .submit-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
        }
        .result-section {
            margin-top: 40px;
            padding: 30px;
            background-color: #e6ffee;
            border-radius: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            text-align: left;
            animation: slideIn 0.8s ease-out;
        }
        @keyframes slideIn {
            from { opacity: 0; transform: translateX(-20px); }
            to { opacity: 1; transform: translateX(0); }
        }
        .result-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #28a745;
            margin-bottom: 20px;
            text-align: center;
        }
        .score-item {
            font-size: 1.1rem;
            margin-bottom: 10px;
            color: #333;
        }
        .feedback-item {
            margin-top: 20px;
            padding: 15px;
            background-color: #fff3cd;
            border-left: 5px solid #ffc107;
            border-radius: 8px;
            font-size: 1rem;
            color: #6a4f00;
            line-height: 1.5;
        }
        .feedback-item strong {
            color: #d39e00;
        }
        .overall-feedback-item { /* 新しいスタイル */
            margin-top: 20px;
            padding: 15px;
            background-color: #e0f2fe; /* 明るい青 */
            border-left: 5px solid #007bff; /* 青 */
            border-radius: 8px;
            font-size: 1rem;
            color: #004085; /* 濃い青 */
            line-height: 1.5;
        }
        .overall-feedback-item strong { /* 新しいスタイル */
            color: #0056b3; /* さらに濃い青 */
        }
        .quote-section {
            margin-top: 30px;
            padding: 20px;
            background-color: #f0f8ff;
            border-radius: 15px;
            border: 1px solid #cce7ff;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
        }
        .quote-text {
            font-size: 1.2rem;
            font-style: italic;
            color: #4a90e2;
            margin-bottom: 10px;
            line-height: 1.6;
        }
        .quote-source {
            font-size: 0.9rem;
            color: #666;
            text-align: right;
        }
        .hidden {
            display: none;
        }
        .progress-bar-container {
            width: 100%;
            background-color: #e0e0e0;
            border-radius: 10px;
            height: 15px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            width: 0%;
            background-color: #4CAF50;
            border-radius: 10px;
            transition: width 0.5s ease-in-out;
        }
        .start-screen {
            background-color: #ffffff;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 40px;
            max-width: 600px;
            width: 100%;
            text-align: center;
            animation: fadeIn 0.8s ease-out;
        }
        .start-screen h1 {
            font-size: 2.5rem;
            font-weight: 700;
            color: #4a90e2;
            margin-bottom: 20px;
        }
        .start-screen p {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 30px;
            line-height: 1.6;
        }
        .start-button {
            background: linear-gradient(45deg, #4CAF50 0%, #8bc34a 100%);
            color: white;
            padding: 18px 40px;
            border-radius: 12px;
            border: none;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }
        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.3);
        }
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 1; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }
        .modal-content {
            background-color: #fefefe;
            margin: auto;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            width: 80%;
            max-width: 500px;
            text-align: center;
            animation: zoomIn 0.3s ease-out;
        }
        @keyframes zoomIn {
            from { transform: scale(0.8); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        .modal-content h2 {
            font-size: 1.8rem;
            color: #333;
            margin-bottom: 20px;
        }
        .modal-content p {
            font-size: 1.1rem;
            color: #555;
            margin-bottom: 25px;
        }
        .modal-button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: background-color 0.3s ease;
        }
        .modal-button:hover {
            background-color: #45a049;
        }
        .progress-text {
            font-size: 1rem;
            color: #666;
            margin-bottom: 15px;
        }
    </style>
</head>
<body>
    <div id="startScreen" class="start-screen">
        <h1>見取り力向上アプリ</h1>
        <p>学生の非認知能力を伸ばすための教員の見取り力を高めるアプリです。「気づき」「読み解き」「意味づけ」の3つの視点から、あなたの見取り力を診断しましょう。</p>
        <button id="startButton" class="start-button">診断を開始する</button>
    </div>

    <div id="quizContainer" class="container hidden">
        <h2 class="text-3xl font-bold text-gray-800 mb-6">見取り力診断クイズ</h2>

        <!-- 各セクションの進捗表示 -->
        <p class="progress-text" id="questionProgress"></p>

        <!-- 気づきセクション -->
        <div id="kizukiSection" class="quiz-section hidden">
            <h3 class="text-2xl font-semibold text-blue-600 mb-4">「気づき」の視点</h3>
            <p class="question-text" id="kizukiQuestion"></p>
            <div class="options-grid" id="kizukiOptions"></div>
        </div>

        <!-- 読み解きセクション -->
        <div id="yomitoSection" class="quiz-section hidden">
            <h3 class="text-2xl font-semibold text-purple-600 mb-4">「読み解き」の視点</h3>
            <p class="question-text" id="yomitoQuestion"></p>
            <div class="options-grid" id="yomitoOptions"></div>
        </div>

        <!-- 意味づけセクション -->
        <div id="imitsukeSection" class="quiz-section hidden">
            <h3 class="text-2xl font-semibold text-green-600 mb-4">「意味づけ」の視点</h3>
            <p class="question-text" id="imitsukeQuestion"></p>
            <div class="options-grid" id="imitsukeOptions"></div>
        </div>

        <!-- 「次の問題へ」ボタンは自動遷移のため削除 -->
        <button id="submitQuiz" class="submit-button hidden">結果を見る</button>
    </div>

    <div id="resultContainer" class="container hidden">
        <h2 class="result-title">診断結果</h2>
        <div class="progress-bar-container">
            <div id="overallProgressBar" class="progress-bar"></div>
        </div>
        <div class="score-item"><strong>気づきスコア:</strong> <span id="kizukiScore"></span> / 5</div>
        <div class="score-item"><strong>読み解きスコア:</strong> <span id="yomitoScore"></span> / 5</div>
        <div class="score-item"><strong>意味づけスコア:</strong> <span id="imitsukeScore"></span> / 5</div>
        <div class="score-item"><strong>総合スコア:</strong> <span id="overallScore"></span> / 15</div>

        <div class="feedback-item" id="kizukiFeedback">
            <strong>「気づき」に関するフィードバック:</strong> <span id="kizukiFeedbackText"></span>
        </div>
        <div class="feedback-item" id="yomitoFeedback">
            <strong>「読み解き」に関するフィードバック:</strong> <span id="yomitoFeedbackText"></span>
        </div>
        <div class="feedback-item" id="imitsukeFeedback">
            <strong>「意味づけ」に関するフィードバック:</strong> <span id="imitsukeFeedbackText"></span>
        </div>

        <!-- 新しく追加する総評アドバイスセクション -->
        <div class="overall-feedback-item" id="overallFeedback">
            <strong>総評:</strong> <span id="overallFeedbackText"></span>
        </div>

        <!-- 名言セクション -->
        <div class="quote-section">
            <p class="quote-text" id="displayQuote"></p>
            <p class="quote-source" id="quoteSource"></p>
        </div>

        <button id="restartButton" class="submit-button mt-8">もう一度診断する</button>
    </div>

    <!-- Modal for messages -->
    <div id="myModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle"></h2>
            <p id="modalMessage"></p>
            <button id="modalCloseButton" class="modal-button">OK</button>
    </div>
    </div>

    <script>
        // クイズデータ
        const quizData = {
            kizuki: [
                {
                    question: "授業中、いつも活発なAさんが今日は静かで、うつむきがちです。まず、何に気づきますか？",
                    options: [
                        { text: "Aさんの表情が硬く、視線が定まらないこと。", isCorrect: true },
                        { text: "Aさんが普段と違う色のペンを使っていること。", isCorrect: false },
                        { text: "Aさんが休憩時間も席を立たないでいること。", isCorrect: false },
                        { text: "Aさんの机の上の教科書がいつもより開いていないこと。", isCorrect: false }
                    ],
                    feedback: "正解です！「気づき」の第一歩は、普段との違いや些細な変化に目を向けることです。Aさんの内面に寄り添う視点が良いですね。"
                },
                {
                    question: "発表が苦手なBさんが、今日のプレゼンテーションでは驚くほど流暢に話しています。何に気づきますか？",
                    options: [
                        { text: "Bさんがいつもより声のトーンが高く、自信に満ちていること。", isCorrect: true },
                        { text: "Bさんが発表中に時々、原稿に目を落としていること。", isCorrect: false },
                        { text: "Bさんのプレゼンテーション資料がいつもよりカラフルであること。", isCorrect: false },
                        { text: "他の学生がBさんの発表に熱心に耳を傾けていること。", isCorrect: false }
                    ],
                    feedback: "正解です！Bさんの自信が声や態度に表れていることに気づくのは素晴らしいです。ポジティブな変化を見逃さないことが大切です。"
                },
                {
                    question: "いつも課題を素早くこなすCさんが、今日の演習では珍しく手が止まり、考え込んでいる様子です。何に気づきますか？",
                    options: [
                        { text: "Cさんが課題の特定の箇所で何度もペンを動かしたり止めたりしていること。", isCorrect: true },
                        { text: "Cさんの机の上がいつもより散らかっていること。", isCorrect: false },
                        { text: "Cさんが時々、隣の学生の様子を気にしていること。", isCorrect: false },
                        { text: "演習室の室温がいつもより低いこと。", isCorrect: false }
                    ],
                    feedback: "正解です！Cさんの普段との違いに気づくことが重要です。行動の細部に注目することで、思考のプロセスや困難に直面している可能性が見えてきます。"
                },
                {
                    question: "普段は時間厳守のDさんが、今日の授業に遅れて入室してきました。何に気づきますか？",
                    options: [
                        { text: "Dさんが入室時に少し息を切らしており、顔が赤らんでいること。", isCorrect: true },
                        { text: "Dさんがいつもと違うカバンを持っていること。", isCorrect: false },
                        { text: "Dさんが着席後、すぐにスマホをチェックしていること。", isCorrect: false },
                        { text: "教室の時計が少し進んでいること。", isCorrect: false }
                    ],
                    feedback: "正解です！外見や身体的な変化に気づくことは、学生の状況を把握する上で大切な情報源となります。焦りや体調不良のサインかもしれません。"
                },
                {
                    question: "普段はあまり発言しないEさんが、休み時間に友人たちと大きな声で笑い、活発に話しています。何に気づきますか？",
                    options: [
                        { text: "Eさんの会話の中心に、新しい趣味の話題があること。", isCorrect: true },
                        { text: "Eさんのグループの人数がいつもより多いこと。", isCorrect: false },
                        { text: "Eさんが新しいヘアスタイルにしていること。", isCorrect: false },
                        { text: "Eさんが持っている飲み物がいつもと違うこと。", isCorrect: false }
                    ],
                    feedback: "正解です！学生の興味や関心の変化に気づくことは、その学生の成長や内面の変化を捉える手がかりになります。ポジティブな変化を見逃さないようにしましょう。"
                }
            ],
            yomito: [
                {
                    question: "いつも整理整頓されているFさんの机が、最近少し散らかっていることに気づきました。その理由を「読み解く」ために、どのような仮説を立てますか？",
                    options: [
                        { text: "Fさんが学業以外の活動（部活動、アルバイトなど）に時間を割いており、多忙になっている可能性がある。", isCorrect: true },
                        { text: "Fさんが急に整理整頓が苦手になったと考える。", isCorrect: false },
                        { text: "Fさんが新しい文房具をたくさん買ったため、机が狭くなったと考える。", isCorrect: false },
                        { text: "Fさんが部屋の掃除を怠けているだけだと決めつける。", isCorrect: false }
                    ],
                    feedback: "正解です！「読み解き」では、表面的な行動だけでなく、その背景にある生活状況や心理状態を推測する視点が重要です。多忙による影響はよくあるケースです。"
                },
                {
                    question: "積極的に質問をするGさんが、今日の専門科目の授業では一度も質問をしません。この行動の理由を「読み解く」ために、どのような観点から考えますか？",
                    options: [
                        { text: "授業内容がGさんにとって非常に簡単で、疑問点がないのかもしれない。", isCorrect: true },
                        { text: "Gさんが授業に興味を失ったと判断する。", isCorrect: false },
                        { text: "Gさんが体調不良で発言する元気がないと決めつける。", isCorrect: false },
                        { text: "Gさんが質問の仕方を忘れてしまったと考える。", isCorrect: false }
                    ],
                    feedback: "正解です！「読み解き」では、ポジティブな可能性も考慮することが大切です。理解度が高いから質問がない、という視点も持ちましょう。"
                },
                {
                    question: "普段は個人で課題に取り組むことを好むHさんが、今回のプロジェクトではグループワークを希望してきました。この変化の理由を「読み解く」ために、どのような情報を重視しますか？",
                    options: [
                        { text: "プロジェクトのテーマが、Hさんの個人では達成困難な規模や内容であるか。", isCorrect: true },
                        { text: "Hさんが最近、友人関係で悩みを抱えているかどうか。", isCorrect: false },
                        { text: "Hさんがグループワークの楽しさに目覚めたと考える。", isCorrect: false },
                        { text: "Hさんが単に他の人に手伝ってほしいだけだと判断する。", isCorrect: false }
                    ],
                    feedback: "正解です！「読み解き」では、学生の学習状況や課題の特性と行動を結びつけて考えることが重要です。課題の難易度が協働を促した可能性を探りましょう。"
                },
                {
                    question: "普段はあまり目を合わせないIさんが、最近、教員や友人と話す際にしっかりと目を合わせるようになりました。この変化の理由を「読み解く」ために、どのような仮説を立てますか？",
                    options: [
                        { text: "Iさんが自己肯定感を高める経験をしたか、コミュニケーションへの意識が変化した可能性がある。", isCorrect: true },
                        { text: "Iさんがコンタクトレンズを使い始めたと考える。", isCorrect: false },
                        { text: "Iさんが単に教員や友人の顔をよく見たいだけだと考える。", isCorrect: false },
                        { text: "Iさんが誰かに目を合わせるように指導されたと決めつける。", isCorrect: false }
                    ],
                    feedback: "正解です！「読み解き」では、学生の内面的な成長や意識の変化に焦点を当てることが重要です。ポジティブな変化の背景には、自己成長のきっかけがあるかもしれません。"
                },
                {
                    question: "授業中は静かなJさんが、オンラインの学習プラットフォームでは活発にコメントしたり、質問したりしています。この行動の理由を「読み解く」ために、どのような観点から考えますか？",
                    options: [
                        { text: "Jさんが対面での発言に抵抗があるが、テキストベースのコミュニケーションでは力を発揮しやすいタイプである。", isCorrect: true },
                        { text: "Jさんがオンライン学習の方が好きだと考える。", isCorrect: false },
                        { text: "Jさんが授業中に集中していないため、後でオンラインで質問していると判断する。", isCorrect: false },
                        { text: "Jさんがオンラインでのみ積極的になれる特別な理由があると決めつける。", isCorrect: false }
                    ],
                    feedback: "正解です！「読み解き」では、学生の多様な学習スタイルやコミュニケーション特性を理解することが重要です。環境によって発揮される能力が異なることを認識しましょう。"
                }
            ],
            imitsuke: [
                {
                    question: "いつも元気なKさんが、最近授業中にうつろな表情で、課題への意欲も低いように見えます。この状況を「読み解き」、Kさんが精神的な疲労を抱えていると判断しました。どのように「意味づけ」し、対応しますか？",
                    options: [
                        { text: "Kさんの状況を深刻に捉え、まずは個別面談で心の状態を確認し、必要に応じてカウンセリングなどの専門的支援を提案する。", isCorrect: true },
                        { text: "Kさんに「疲れているの？」と軽く声をかけるだけで、あとはKさんの自主性に任せる。", isCorrect: false },
                        { text: "Kさんの成績が落ちないよう、課題の量を減らしてあげる。", isCorrect: false },
                        { text: "Kさんが一時的にやる気を失っているだけだと判断し、特に何もしない。", isCorrect: false }
                    ],
                    feedback: "正解です！「意味づけ」は、その後の具体的な行動につながる重要なステップです。学生の状況を深く理解し、適切なサポートを検討する姿勢が素晴らしいです。早期の専門的支援の検討は非常に重要です。"
                },
                {
                    question: "常に課題提出が遅れがちだったLさんが、今回の課題を期限より早く提出してきました。この変化を「読み解き」、Lさんが学習への意識を高めたと判断しました。どのように「意味づけ」し、対応しますか？",
                    options: [
                        { text: "Lさんの努力を具体的に称賛し、その意識をさらに伸ばすために、次のステップとしてより挑戦的な課題や学習機会を提案する。", isCorrect: true },
                        { text: "Lさんに「今回は早かったね」とだけ伝え、特に深掘りはしない。", isCorrect: false },
                        { text: "Lさんがたまたま早くできただけだと考え、過度な期待はしない。", isCorrect: false },
                        { text: "他の学生にもLさんを見習うように全体で促す。", isCorrect: false }
                    ],
                    feedback: "正解です！「意味づけ」では、学生のポジティブな変化を捉え、それをさらに伸ばすための具体的な働きかけが重要です。学習意欲の向上につながるフィードバックは素晴らしいです。"
                },
                {
                    question: "普段は授業中にほとんど発言しないMさんが、ある学生が不当な批判を受けた際に、その学生を擁護する発言をしました。この行動を「読み解き」、Mさんが強い正義感と共感性を持っていると判断しました。どのように「意味づけ」し、対応しますか？",
                    options: [
                        { text: "Mさんの勇気ある行動と共感性を高く評価し、その行動を具体的に褒め、今後も安心して意見を表明できるようなクラスの雰囲気作りを意識する。", isCorrect: true },
                        { text: "Mさんが珍しく発言したことについて、特に触れずに見守る。", isCorrect: false },
                        { text: "Mさんが感情的になっているだけだと考え、冷静になるよう促す。", isCorrect: false },
                        { text: "Mさんの発言が授業の進行を妨げたとして、注意を与える。", isCorrect: false }
                    ],
                    feedback: "正解です！「意味づけ」では、学生の行動の背景にある内面的な特性を肯定的に捉え、それを今後の成長につなげるための環境を整えることが重要です。勇気を称えることは大きな自信につながります。"
                },
                {
                    question: "ある科目に苦手意識を持っていたNさんが、最近の小テストで大幅に点数を伸ばしました。この変化を「読み解き」、Nさんが学習方法を改善し、努力が実を結んだと判断しました。どのように「意味づけ」し、対応しますか？",
                    options: [
                        { text: "Nさんの努力と成果を具体的に認め、成功体験を言語化させることで自信を深めさせ、他の科目への応用やさらなる学習意欲向上に繋げる。", isCorrect: true },
                        { text: "Nさんに「よく頑張ったね」とだけ伝え、次のテストも頑張るように促す。", isCorrect: false },
                        { text: "Nさんがたまたま良い点数を取れただけだと考え、特に何もしない。", isCorrect: false },
                        { text: "Nさんの成功事例を他の苦手な学生に共有させる。", isCorrect: false }
                    ],
                    feedback: "正解です！「意味づけ」では、学生の成功を具体的に評価し、その成功要因を学生自身が認識することで、自己効力感を高めることが重要です。他の学習への波及効果も期待できます。"
                },
                {
                    question: "普段は一人で問題を解決しようとするOさんが、最近、友人や教員に積極的に質問したり、助けを求めたりするようになりました。この変化を「読み解き」、Oさんが協調性や他者との連携の重要性を認識し始めたと判断しました。どのように「意味づけ」し、対応しますか？",
                    options: [
                        { text: "Oさんの変化をポジティブに捉え、協働学習の機会をさらに提供したり、Oさんが他者と協力する中で新たな学びを得られるようサポートする。", isCorrect: true },
                        { text: "Oさんが弱気になったと判断し、もっと自力で頑張るように促す。", isCorrect: false },
                        { text: "Oさんが依存的になっているのではないかと懸念し、見守る。", isCorrect: false },
                        { text: "Oさんが質問ばかりして他の学生の邪魔にならないよう注意する。", isCorrect: false }
                    ],
                    feedback: "正解です！「意味づけ」では、学生の行動の背景にあるポジティブな側面を見出し、それを成長の機会と捉えることが重要です。協調性の芽生えを育むための働きかけは、非認知能力の向上に繋がります。"
                }
            ]
        };

        // 名言データ
        const quotesData = [
            {
                category: "kizuki_high",
                quote: "最も深い洞察は、最も繊細な観察から生まれる。",
                source: "レオナルド・ダ・ヴィンチ（芸術家・科学者）"
            },
            {
                category: "kizuki_low",
                quote: "見ることは、ただ目を向けることではない。心で感じ、理解することだ。",
                source: "ヘレン・ケラー（教育家・社会福祉活動家）"
            },
            {
                category: "yomito_high",
                quote: "真の教育とは、事実を学ぶことではなく、心を考えるように訓練することである。",
                source: "アルベルト・アインシュタイン（物理学者）"
            },
            {
                category: "yomito_low",
                quote: "理解とは、表面的なものを見るのではなく、その奥にあるものを探ることである。",
                source: "ソクラテス（哲学者）"
            },
            {
                category: "imitsuke_high",
                quote: "行動なくして、いかなる偉大な成果も得られない。",
                source: "マハトマ・ガンディー（思想家・政治指導者）"
            },
            {
                category: "imitsuke_low",
                quote: "知識は力なり。しかし、それをどう使うかが重要である。",
                source: "フランシス・ベーコン（哲学者）"
            },
            {
                category: "balanced",
                quote: "教育の目的は、生徒が自分自身を理解し、世界を理解し、そしてその世界に貢献する方法を見つけるのを助けることである。",
                source: "ジョン・デューイ（哲学者・教育学者）"
            },
            {
                category: "overall_high",
                quote: "学び続ける限り、人は成長し続ける。",
                source: "ピーター・ドラッカー（経営学者）"
            },
            {
                category: "overall_low",
                quote: "千里の道も一歩から。",
                source: "老子（思想家）"
            },
            {
                category: "default",
                quote: "教育とは、人生のための準備ではなく、人生そのものである。",
                source: "ジョン・デューイ（哲学者・教育学者）"
            }
        ];

        let currentCategoryIndex = 0;
        let currentQuestionIndex = 0;
        let selectedOption = null;
        let scores = {
            kizuki: 0,
            yomito: 0,
            imitsuke: 0
        };
        const categories = ['kizuki', 'yomito', 'imitsuke'];

        // DOM要素の取得
        const startScreen = document.getElementById('startScreen');
        const startButton = document.getElementById('startButton');
        const quizContainer = document.getElementById('quizContainer');
        const kizukiSection = document.getElementById('kizukiSection');
        const yomitoSection = document.getElementById('yomitoSection');
        const imitsukeSection = document.getElementById('imitsukeSection');
        const kizukiQuestionElem = document.getElementById('kizukiQuestion');
        const kizukiOptionsElem = document.getElementById('kizukiOptions');
        const yomitoQuestionElem = document.getElementById('yomitoQuestion');
        const yomitoOptionsElem = document.getElementById('yomitoOptions');
        const imitsukeQuestionElem = document.getElementById('imitsukeQuestion');
        const imitsukeOptionsElem = document.getElementById('imitsukeOptions');
        const submitQuizButton = document.getElementById('submitQuiz');
        const resultContainer = document.getElementById('resultContainer');
        const kizukiScoreElem = document.getElementById('kizukiScore');
        const yomitoScoreElem = document.getElementById('yomitoScore');
        const imitsukeScoreElem = document.getElementById('imitsukeScore');
        const overallScoreElem = document.getElementById('overallScore');
        const kizukiFeedbackTextElem = document.getElementById('kizukiFeedbackText');
        const yomitoFeedbackTextElem = document.getElementById('yomitoFeedbackText');
        const imitsukeFeedbackTextElem = document.getElementById('imitsukeFeedbackText');
        const overallFeedbackTextElem = document.getElementById('overallFeedbackText'); // 総評アドバイス要素
        const displayQuoteElem = document.getElementById('displayQuote');
        const quoteSourceElem = document.getElementById('quoteSource');
        const restartButton = document.getElementById('restartButton');
        const overallProgressBar = document.getElementById('overallProgressBar');
        const questionProgressElem = document.getElementById('questionProgress'); // 進捗表示要素

        const modal = document.getElementById('myModal');
        const modalTitle = document.getElementById('modalTitle');
        const modalMessage = document.getElementById('modalMessage');
        const modalCloseButton = document.getElementById('modalCloseButton');

        // モーダルを表示する関数
        function showModal(title, message) {
            modalTitle.textContent = title;
            modalMessage.textContent = message;
            modal.style.display = 'flex'; // Flexboxを使って中央寄せ
        }

        // モーダルを閉じる関数
        modalCloseButton.onclick = function() {
            modal.style.display = 'none';
        }

        // モーダルの外側をクリックで閉じる
        window.onclick = function(event) {
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        // 配列をシャッフルする関数 (Fisher-Yatesアルゴリズム)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        // クイズの初期化
        function initializeQuiz() {
            currentCategoryIndex = 0;
            currentQuestionIndex = 0;
            scores = { kizuki: 0, yomito: 0, imitsuke: 0 };
            startScreen.classList.add('hidden');
            quizContainer.classList.remove('hidden');
            resultContainer.classList.add('hidden');
            submitQuizButton.classList.add('hidden');
            loadQuestion();
        }

        // 問題をロードする
        function loadQuestion() {
            const currentCategory = categories[currentCategoryIndex];
            const questions = quizData[currentCategory];
            const questionData = questions[currentQuestionIndex];

            // 全てのセクションを非表示にする
            kizukiSection.classList.add('hidden');
            yomitoSection.classList.add('hidden');
            imitsukeSection.classList.add('hidden');

            let questionElem, optionsElem;
            let categoryName = "";

            // 現在のカテゴリのセクションを表示し、問題と選択肢をセット
            if (currentCategory === 'kizuki') {
                kizukiSection.classList.remove('hidden');
                questionElem = kizukiQuestionElem;
                optionsElem = kizukiOptionsElem;
                categoryName = "「気づき」の視点";
            } else if (currentCategory === 'yomito') {
                yomitoSection.classList.remove('hidden');
                questionElem = yomitoQuestionElem;
                optionsElem = yomitoOptionsElem;
                categoryName = "「読み解き」の視点";
            } else if (currentCategory === 'imitsuke') {
                imitsukeSection.classList.remove('hidden');
                questionElem = imitsukeQuestionElem;
                optionsElem = imitsukeOptionsElem;
                categoryName = "「意味づけ」の視点";
            }

            // 進捗表示を更新
            questionProgressElem.textContent = `${categoryName} - ${currentQuestionIndex + 1} / ${questions.length} 問`;

            questionElem.textContent = questionData.question;
            optionsElem.innerHTML = ''; // 選択肢をクリア

            // 選択肢をシャッフル
            const shuffledOptions = shuffleArray([...questionData.options]);

            shuffledOptions.forEach((option, index) => {
                const button = document.createElement('button');
                button.classList.add('option-button');
                button.textContent = option.text;
                // シャッフル後のインデックスではなく、元のoptions配列でのisCorrect判定を直接使用
                button.dataset.isCorrect = option.isCorrect; // isCorrectをデータ属性として保持
                button.addEventListener('click', () => handleOptionSelection(button)); // isCorrectを引数から削除
                optionsElem.appendChild(button);
            });

            selectedOption = null; // 選択肢をリセット
            submitQuizButton.classList.add('hidden'); // 結果を見るボタンを非表示
        }

        // 選択肢を選択したときの処理 (自動遷移)
        function handleOptionSelection(button) { // isCorrect引数を削除
            // 既に選択されている選択肢があれば、selectedクラスを削除
            if (selectedOption) {
                selectedOption.classList.remove('selected');
            }
            // 新しく選択された選択肢にselectedクラスを追加
            button.classList.add('selected');
            selectedOption = button;

            // スコアを計算
            const currentCategory = categories[currentCategoryIndex];
            // isCorrectをデータ属性から取得
            const isCorrect = selectedOption.dataset.isCorrect === 'true';

            if (isCorrect) {
                scores[currentCategory]++;
            }

            // 短い遅延後に次の問題へ、または結果表示へ
            setTimeout(() => {
                currentQuestionIndex++;
                if (currentQuestionIndex < quizData[currentCategory].length) { // quizData[currentCategory].lengthで現在のカテゴリの問題数を取得
                    loadQuestion(); // 同じカテゴリの次の問題へ
                } else {
                    currentCategoryIndex++;
                    currentQuestionIndex = 0; // 次のカテゴリの最初の問題へ
                    if (currentCategoryIndex < categories.length) {
                        loadQuestion();
                    } else {
                        // 全てのクイズが終了したら結果を表示
                        displayResults();
                    }
                }
            }, 500); // 0.5秒の遅延
        }

        // クイズを提出して結果を表示する処理 (最終問題のみ)
        submitQuizButton.addEventListener('click', () => {
            // このボタンは最後の問題でのみ表示されるため、選択済みであることを前提とする
            displayResults();
        });

        // 結果を表示する
        function displayResults() {
            quizContainer.classList.add('hidden');
            resultContainer.classList.remove('hidden');

            const totalScore = scores.kizuki + scores.yomito + scores.imitsuke;

            kizukiScoreElem.textContent = scores.kizuki;
            yomitoScoreElem.textContent = scores.yomito;
            imitsukeScoreElem.textContent = scores.imitsuke;
            overallScoreElem.textContent = totalScore;

            // プログレスバーの更新
            const overallProgress = (totalScore / 15) * 100;
            overallProgressBar.style.width = overallProgress + '%';
            if (overallProgress < 50) {
                overallProgressBar.style.backgroundColor = '#ffc107'; // Yellow for low score
            } else if (overallProgress < 80) {
                overallProgressBar.style.backgroundColor = '#28a745'; // Green for medium score
            } else {
                overallProgressBar.style.backgroundColor = '#007bff'; // Blue for high score
            }

            // フィードバックの生成
            kizukiFeedbackTextElem.textContent = generateFeedback('kizuki', scores.kizuki);
            yomitoFeedbackTextElem.textContent = generateFeedback('yomito', scores.yomito);
            imitsukeFeedbackTextElem.textContent = generateFeedback('imitsuke', scores.imitsuke);
            overallFeedbackTextElem.textContent = generateOverallFeedback(scores); // 総評アドバイスの生成

            // 名言の表示
            const { quote, source } = generateQuote(scores);
            displayQuoteElem.textContent = `「${quote}」`;
            quoteSourceElem.textContent = `— ${source}`;
        }

        // フィードバック生成関数
        function generateFeedback(category, score) {
            let feedback = "";
            if (category === 'kizuki') {
                if (score >= 4) {
                    feedback = "素晴らしいです！あなたは学生の些細な変化や普段との違いによく気づくことができます。この高い「気づき」の力は、学生の非認知能力を伸ばす上で非常に重要です。さらに多角的な視点を持つことで、より深い気づきにつながるでしょう。**具体的には、学生の行動だけでなく、表情、声のトーン、持ち物、周囲との関わり方など、より多くの情報源に意識的に目を向けてみましょう。**";
                } else if (score >= 2) {
                    feedback = "良い「気づき」の力を持っています。学生の行動や表情の変化に意識を向けることで、さらに多くの「気づき」を得られるようになります。日々の観察を意識的に行うことで、見取りの解像度を高めましょう。**具体的には、一人の学生を数分間、意識的に観察する時間を作ってみましょう。その際、「普段と違う点はないか？」「どんな時に表情が変わるか？」といった問いを自分に投げかけてみてください。**";
                } else {
                    feedback = "「気づき」の力をさらに高める必要があります。学生の行動の背景にあるサインを見逃さないよう、日々の観察をより意識的に行いましょう。特に、普段と違う点や、些細な変化に目を向ける練習が効果的です。**まずは、毎日一人、特定の学生を決めて、その学生の「今日の様子」を簡単なメモに残すことから始めてみましょう。授業中の姿勢、休み時間の過ごし方など、具体的な行動に焦点を当ててみてください。**";
                }
            } else if (category === 'yomito') {
                if (score >= 4) {
                    feedback = "見事です！あなたは学生の行動の背景にある理由や原因を深く「読み解く」ことができます。多角的な視点から情報を統合し、本質を捉える力が優れています。この力を活かし、学生一人ひとりに寄り添った支援を続けてください。**具体的には、読み解いた仮説を同僚の先生と共有し、異なる視点からの意見を聞くことで、さらに多角的な思考を深めることができます。**";
                } else if (score >= 2) {
                    feedback = "「読み解き」の力は良好です。学生の行動の背景を考える習慣はついていますが、さらに多角的な情報（過去のデータ、他の教員の意見など）を取り入れることで、より正確な「読み解き」が可能になります。仮説を立てて検証する練習も有効です。**具体的には、学生の行動を見たときに「なぜだろう？」と問いかけ、考えられる理由を3つ以上書き出してみましょう。そして、それぞれの理由を裏付ける情報や、反証する情報がないかを探る練習をしてみてください。**";
                } else {
                    feedback = "「読み解き」の力を向上させる余地があります。学生の行動に対して、安易に決めつけず、なぜそのような行動をとったのかを深く考える習慣をつけましょう。情報収集の幅を広げ、様々な可能性を検討することが重要です。**具体的には、学生の行動を見たときに、すぐに結論を出さずに「もしかしたら〇〇かもしれないし、△△かもしれない」と複数の可能性を考える癖をつけましょう。そして、その可能性を検証するために、どのような情報が必要かを考えてみてください。**";
                }
            } else if (category === 'imitsuke') {
                if (score >= 4) {
                    feedback = "素晴らしい「意味づけ」の力です！あなたは学生の行動や状況を、その後の具体的な支援や成長の機会へと適切に「意味づける」ことができます。あなたのフィードバックや働きかけは、学生の非認知能力の向上に大きく貢献するでしょう。**具体的には、意味づけの結果を学生本人にフィードバックする際、彼らが自身の成長を実感できるような言葉を選び、次の目標設定をサポートしてみましょう。**";
                } else if (score >= 2) {
                    feedback = "「意味づけ」の力は十分です。学生の行動をポジティブに捉え、具体的な支援につなげようとする姿勢は素晴らしいです。さらに、長期的な視点や、非認知能力との関連性を意識することで、より戦略的な「意味づけ」が可能になります。**具体的には、学生の行動を意味づける際に、「この行動は、どの非認知能力（例：粘り強さ、協調性、自己調整力など）の成長に繋がるだろうか？」と考えてみましょう。そして、その能力をさらに伸ばすための具体的な声かけや活動を計画してみてください。**";
                } else {
                    feedback = "「意味づけ」の力をさらに強化する必要があります。学生の行動を単なる問題として捉えるだけでなく、それをどのように成長の機会に変えるか、具体的な支援策としてどう落とし込むかを意識しましょう。非認知能力の観点から「意味づけ」を深める練習が効果的です。**具体的には、学生の課題や良い行動を見つけた際に、「この状況をどうポジティブに捉え、どんな働きかけをすれば、学生のどんな非認知能力が伸びるか？」という視点で、具体的な支援策を1つ考えてみましょう。**";
                }
            }
            return feedback;
        }

        // 総評アドバイス生成関数
        function generateOverallFeedback(scores) {
            const totalScore = scores.kizuki + scores.yomito + scores.imitsuke;
            let overallFeedback = "";

            if (totalScore >= 12) {
                overallFeedback = "あなたの見取り力は非常に高く、学生の些細な変化から深い内面までを捉え、適切な支援へと繋げることができています。この優れた能力を活かし、チーム全体の見取り力向上にも貢献できるでしょう。常に学び続け、さらに高みを目指してください。";
            } else if (totalScore >= 8) {
                overallFeedback = "あなたの見取り力は着実に育まれています。各視点でのバランスも良く、学生への丁寧な関わりができている証拠です。さらに特定の分野を深掘りしたり、多様な学生のケースに触れたりすることで、あなたの見取り力は一層磨かれるでしょう。";
            } else if (totalScore >= 4) {
                overallFeedback = "見取り力の基礎は備わっていますが、まだ伸びしろが多くあります。特に、学生の行動の背景を深く探る「読み解き」や、その情報を具体的な支援に繋げる「意味づけ」に意識を向けることで、より質の高い見取りができるようになります。日々の実践の中で、意識的に3つの視点を活用してみてください。";
                } else {
                overallFeedback = "見取り力を高めるための第一歩を踏み出しましたね。まずは、学生の行動や表情の「気づき」から始め、なぜそうなのかを「読み解き」、どう関わるべきかを「意味づける」という一連の流れを意識することが重要です。焦らず、一つずつ実践を重ねていきましょう。";
            }
            return overallFeedback;
        }


        // 名言生成関数
        function generateQuote(scores) {
            const totalScore = scores.kizuki + scores.yomito + scores.imitsuke;
            let chosenQuote = null;

            // スコア傾向に基づいて名言を選択
            if (scores.kizuki >= 4 && scores.yomito >= 4 && scores.imitsuke >= 4) {
                chosenQuote = quotesData.find(q => q.category === "overall_high");
            } else if (totalScore <= 5) { // 総合スコアが低い場合
                chosenQuote = quotesData.find(q => q.category === "overall_low");
            } else if (scores.kizuki >= 4) {
                chosenQuote = quotesData.find(q => q.category === "kizuki_high");
            } else if (scores.kizuki <= 1) {
                chosenQuote = quotesData.find(q => q.category === "kizuki_low");
            } else if (scores.yomito >= 4) {
                chosenQuote = quotesData.find(q => q.category === "yomito_high");
            } else if (scores.yomito <= 1) {
                chosenQuote = quotesData.find(q => q.category === "yomito_low");
            } else if (scores.imitsuke >= 4) {
                chosenQuote = quotesData.find(q => q.category === "imitsuke_high");
            } else if (scores.imitsuke <= 1) {
                chosenQuote = quotesData.find(q => q.category === "imitsuke_low");
            } else {
                chosenQuote = quotesData.find(q => q.category === "balanced");
            }

            // 適切な名言が見つからなければ、デフォルトを返す
            return chosenQuote || quotesData.find(q => q.category === "default");
        }

        // 再スタートボタン
        restartButton.addEventListener('click', () => {
            resultContainer.classList.add('hidden');
            startScreen.classList.remove('hidden');
            // クイズの状態をリセット
            currentCategoryIndex = 0;
            currentQuestionIndex = 0;
            scores = { kizuki: 0, yomito: 0, imitsuke: 0 };
            selectedOption = null;
        });

        // 開始ボタンのイベントリスナー
        startButton.addEventListener('click', initializeQuiz);

        // ページロード時にスタート画面を表示
        window.onload = function() {
            startScreen.classList.remove('hidden');
            quizContainer.classList.add('hidden');
            resultContainer.classList.add('hidden');
        };

    </script>
</body>
</html>

